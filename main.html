<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MargdarshAI — Mock Demo</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50 min-h-screen flex items-center justify-center p-6">
<div class="w-full max-w-3xl bg-white rounded-lg shadow-lg p-6">
  <div class="flex items-center gap-4">
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHe..." alt="logo" class="w-16 h-16 rounded"/>
    <div>
      <h1 class="text-2xl font-semibold">MargdarshAI — Mock Prototype</h1>
      <p class="text-sm text-gray-600">Personalized career suggestions · mock LLM responses · PDF export</p>
    </div>
  </div>

  <!-- Intake -->
  <section class="mt-6">
    <h2 class="text-lg font-medium">Student Profile (prefilled)</h2>
    <form id="profileForm" class="grid grid-cols-1 md:grid-cols-2 gap-3 mt-3">
      <div>
        <label class="text-sm">Name</label>
        <input id="name" class="w-full border rounded p-2" value="Harshil Patel" />
      </div>
      <div>
        <label class="text-sm">Age</label>
        <input id="age" class="w-full border rounded p-2" value="20" />
      </div>
      <div>
        <label class="text-sm">Education</label>
        <input id="education" class="w-full border rounded p-2" value="BTech Computer Engineering" />
      </div>
      <div>
        <label class="text-sm">City</label>
        <input id="city" class="w-full border rounded p-2" value="Bhavnagar, Gujarat" />
      </div>
      <div class="md:col-span-2">
        <label class="text-sm">Interests (comma-separated)</label>
        <input id="interests" class="w-full border rounded p-2" value="Cyber security, Cloud, DevOps" />
      </div>
      <div class="md:col-span-2">
        <label class="text-sm">Strengths (comma-separated)</label>
        <input id="strengths" class="w-full border rounded p-2" value="Good communication, Deterministic" />
      </div>

      <div class="md:col-span-2 flex gap-3 mt-2">
        <button id="generateBtn" type="button" class="bg-blue-600 text-white px-4 py-2 rounded">Generate Suggestions</button>
        <button id="resetBtn" type="button" class="border px-4 py-2 rounded">Reset</button>
      </div>
    </form>
  </section>

  <!-- Results -->
  <section id="results" class="mt-6 hidden">
    <h2 class="text-lg font-medium">Suggestions</h2>
    <div id="suggestions" class="mt-3 space-y-4"></div>

    <div class="mt-4 flex gap-3">
      <button id="exportPdf" class="bg-green-600 text-white px-4 py-2 rounded">Export PDF</button>
      <button id="copySummary" class="border px-4 py-2 rounded">Copy Short Summary</button>
    </div>
  </section>

  <footer class="mt-6 text-xs text-gray-500">Mocked demo. Deterministic outputs for reliable demo.</footer>
</div>

<!-- html2pdf (client-side PDF) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>

<script>
/* ---------- Mock LLM logic (deterministic) ---------- */
function mockSuggestCareer(profile) {
  // Simple deterministic mapping using interests
  const { name, age, education, interests, strengths, city, horizon } = profile;
  // Normalize interests
  const ints = interests.map(s => s.toLowerCase());
  const suggestions = [];

  // If cyber security interest
  if (ints.some(i => i.includes('cyber'))) {
    suggestions.push({
      career: 'Cybersecurity Analyst',
      rank: 1,
      rationale: 'Matches interest in cybersecurity and strong communication for incident reporting.',
      skills: ['Network fundamentals', 'Linux basics', 'Incident response', 'Python scripting', 'Security tools (Wireshark, Metasploit)'],
      roadmap: [
        { step: 'Course', detail: 'Complete a free intro: "Intro to Cybersecurity" (Coursera/edX).'},
        { step: 'Practice', detail: 'Set up a home lab with virtual machines and practice basic pentesting.'},
        { step: 'Project', detail: 'Document a small CTF writeup and share on GitHub.'}
      ]
    });
  }

  // If cloud or devops interest add cloud/devops role
  if (ints.some(i => i.includes('cloud') || i.includes('devops'))) {
    suggestions.push({
      career: 'Cloud DevOps Engineer',
      rank: suggestions.length + 1,
      rationale: 'Cloud and DevOps interests align with automation and deployment responsibilities.',
      skills: ['Linux', 'Docker', 'Kubernetes basics', 'CI/CD (GitHub Actions)', 'Cloud fundamentals (AWS/GCP)'],
      roadmap: [
        { step: 'Course', detail: 'Follow "AWS Cloud Practitioner" or GCP equivalent free course.'},
        { step: 'Practice', detail: 'Containerize a sample app, deploy to a managed Kubernetes demo cluster.'},
        { step: 'Project', detail: 'Create CI pipeline for deployments and document steps.'}
      ]
    });
  }

  // Generic fallback role
  if (suggestions.length < 3) {
    suggestions.push({
      career: 'Site Reliability Engineer (SRE) - Entry',
      rank: suggestions.length + 1,
      rationale: 'Blends reliability, scripting, and system design matching deterministic thinking.',
      skills: ['Scripting (Python/Bash)', 'Monitoring tools', 'Systems & networking', 'Cloud basics', 'Automation'],
      roadmap: [
        { step: 'Course', detail: 'Intro to SRE/read Google SRE book summary.'},
        { step: 'Practice', detail: 'Automate small ops tasks using scripts and cron.'},
        { step: 'Project', detail: 'Build a simple uptime monitor and alerting demo.'}
      ]
    });
  }

  // Shortlist top 3 and include immediate 2 next steps per suggestion (first two roadmap items)
  return suggestions.slice(0,3);
}

/* ---------- UI wiring ---------- */
document.getElementById('generateBtn').addEventListener('click', () => {
  const profile = {
    name: document.getElementById('name').value.trim(),
    age: document.getElementById('age').value.trim(),
    education: document.getElementById('education').value.trim(),
    city: document.getElementById('city').value.trim(),
    interests: document.getElementById('interests').value.split(',').map(s => s.trim()).filter(Boolean),
    strengths: document.getElementById('strengths').value.split(',').map(s => s.trim()).filter(Boolean),
    horizon: '3y'
  };

  const suggestions = mockSuggestCareer(profile);
  renderSuggestions(profile, suggestions);
});

document.getElementById('resetBtn').addEventListener('click', () => location.reload());

function renderSuggestions(profile, suggestions) {
  document.getElementById('results').classList.remove('hidden');
  const container = document.getElementById('suggestions');
  container.innerHTML = '';

  suggestions.forEach((s, idx) => {
    const card = document.createElement('div');
    card.className = 'border rounded p-4 bg-gray-50';
    card.innerHTML = `
      <div class="flex justify-between items-start">
        <div>
          <h3 class="text-md font-semibold">${s.rank}. ${s.career}</h3>
          <p class="text-sm text-gray-700 mt-1">${s.rationale}</p>
        </div>
        <div class="text-xs text-gray-500">Rank ${s.rank}</div>
      </div>

      <div class="mt-3 grid md:grid-cols-2 gap-3">
        <div>
          <h4 class="font-medium text-sm">Top required skills</h4>
          <ul class="list-disc list-inside text-sm mt-1">${s.skills.map(sk => `<li>${sk}</li>`).join('')}</ul>
        </div>
        <div>
          <h4 class="font-medium text-sm">3-step roadmap</h4>
          <ol class="list-decimal list-inside text-sm mt-1">${s.roadmap.map(r => `<li><strong>${r.step}:</strong> ${r.detail}</li>`).join('')}</ol>
        </div>
      </div>

      <div class="mt-3 flex gap-2">
        <button class="selectBtn border px-3 py-1 rounded" data-career="${s.career}">Select</button>
        <button class="copyBtn border px-3 py-1 rounded" data-summary="${escapeHtml(JSON.stringify(s))}">Copy JSON</button>
      </div>
    `;
    container.appendChild(card);
  });

  // attach select handlers
  Array.from(document.querySelectorAll('.selectBtn')).forEach(b => {
    b.addEventListener('click', (ev)=> {
      const career = ev.target.dataset.career;
      alert('Selected: ' + career + '\\nShowing roadmap export as PDF available.');
    });
  });

  Array.from(document.querySelectorAll('.copyBtn')).forEach(b => {
    b.addEventListener('click', ev => {
      const txt = JSON.parse(unescapeHtml(ev.target.dataset.summary));
      navigator.clipboard.writeText(JSON.stringify(txt, null, 2));
      alert('Copied suggestion JSON to clipboard.');
    });
  });

  // export and copy summary
  document.getElementById('exportPdf').onclick = () => {
    const element = document.querySelector('.w-full') || document.body;
    const opt = { margin:0.5, filename: profile.name.replace(/\\s+/g,'_') + '_MargdarshAI_Roadmap.pdf', html2canvas: { scale:1 }, jsPDF: { unit:'in', format:'a4', orientation:'portrait' } };
    html2pdf().set(opt).from(document.querySelector('.max-w-3xl')).save();
  };

  document.getElementById('copySummary').onclick = () => {
    const top = suggestions[0];
    const summary = `${profile.name} (${profile.education}) — Top recommendation: ${top.career}. Next steps: 1) ${top.roadmap[0].detail} 2) ${top.roadmap[1].detail}`;
    navigator.clipboard.writeText(summary);
    alert('Short summary copied to clipboard.');
  };
}

// small helpers
function escapeHtml(s){ return encodeURIComponent(s); }
function unescapeHtml(s){ return decodeURIComponent(s); }
</script>
</body>
</html>